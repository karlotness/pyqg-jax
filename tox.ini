[tox]
envlist = py3, lint
isolated_build = true

[testenv]
description = Run tests
deps =
 -rtests/test_requirements.txt
commands =
  pytest {posargs}
setenv =
  JAX_ENABLE_X64 = True
  JAX_DEFAULT_DTYPE_BITS = 32

[testenv:lint]
description = Check code for style and formatting
basepython = python3
skip_install = true
ignore_errors = true
deps =
  ruff>=0.0.245
  black>=23.1.0,<24
commands =
  ruff check -- src/pyqg_jax/ tests/
  black --check --diff src/pyqg_jax/ tests/
